<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GTA — Practice UI (Solo-Leveling Animated)</title>
<link rel="stylesheet" href="styles.css" />
<style>
/* GTA-only styling + Solo-Leveling flair */
:root{
  --bg:#02020b; --panel:#071026; --accent1:#a855f7; --accent2:#06b6d4; --accent3:#ffb86b;
  --glow1: 0 8px 30px rgba(168,85,247,0.12);
}
body{background:radial-gradient(ellipse at top left,#05030a 0%, #02020b 40%, #03030a 100%); color:#eaf4ff}
.container{max-width:1100px;margin:16px auto;padding:14px}
.h1{font-size:18px;color:var(--accent3);margin:0 0 8px;font-weight:700}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));border-radius:14px;padding:14px;margin-top:14px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 40px rgba(0,0,0,0.6)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.input, select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#eaf4ff;margin-top:8px}
.btn{padding:8px 12px;border-radius:12px;border:none;cursor:pointer;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:#021018;font-weight:800}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:#dfeeff}
.list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.topic{padding:10px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));display:flex;justify-content:space-between;align-items:center;border:1px solid rgba(255,255,255,0.02);position:relative;overflow:hidden}
.topic.latest{animation:logPulse 1200ms ease both}
@keyframes logPulse{
  0%{box-shadow:0 0 0 rgba(168,85,247,0)} 
  30%{box-shadow:0 0 40px rgba(168,85,247,0.18)} 
  100%{box-shadow:0 0 12px rgba(6,182,212,0.06)}
}
.result-btn{min-width:44px;min-height:36px;border-radius:10px;font-size:16px;border:0;cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
.result-btn.correct{background:linear-gradient(90deg,#7c3aed,#a855f7);color:#021018}
.result-btn.incorrect{background:linear-gradient(90deg,#ef4444,#f97316);color:#fff}
.result-btn.un{background:linear-gradient(90deg,#60a5fa,#06b6d4);color:#fff;opacity:0.95}
.badge{font-weight:700;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}

/* timer shimmer while running */
.timer-running { animation: shimmer 900ms linear infinite; }
@keyframes shimmer {
  0%{transform: translateY(0) scale(1)}
  50%{transform: translateY(-1px) scale(1.01)}
  100%{transform: translateY(0) scale(1)}
}

/* particle canvas overlay */
.particle-canvas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999}

/* reduced motion toggle */
.reduced-toggle{margin-left:8px;padding:6px 8px;border-radius:8px;background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.03);cursor:pointer;color:#dfeeff}

/* small responsive */
@media(max-width:720px){
  .row{flex-direction:column}
  .result-btn{min-width:40px;min-height:36px}
}
</style>
</head>
<body>
<canvas id="particle-canvas" class="particle-canvas" aria-hidden="true"></canvas>

<div class="container">
  <div class="header" style="display:flex;align-items:center;gap:12px">
    <div class="brand">Sunstrike — GTA (Solo-Leveling)</div>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
      <button id="reduced-toggle" class="reduced-toggle">Reduced motion: Off</button>
    </div>
  </div>

  <main>
    <div class="card">
      <div class="h1">GTA Session — Practice UI (Animated)</div>
      <div class="small">Solo-Leveling vibe • Non-blocking submits • Mark later • Merge & export</div>

      <div style="margin-top:12px" class="row">
        <div style="flex:1">
          <label class="small">Session Name</label>
          <input id="gta-session" class="input" placeholder="GTA_2025-12-06_001">
        </div>
        <div style="width:140px">
          <label class="small">Total Time (min)</label>
          <select id="gta-total" class="input"><option>180</option><option>120</option><option>90</option><option>60</option></select>
        </div>
        <div style="width:140px">
          <label class="small">Subject</label>
          <select id="gta-sub" class="input"><option>Mixed</option><option>Maths</option><option>Physics</option><option>Chemistry</option></select>
        </div>
        <div style="width:140px">
          <label class="small">Difficulty</label>
          <select id="gta-diff" class="input"><option>Mixed</option><option>Easy</option><option>Medium</option><option>Hard</option><option>Insane</option></select>
        </div>
      </div>

      <div style="margin-top:12px" class="row">
        <button id="gta-start" class="btn">Start GTA</button>
        <button id="gta-end" class="btn ghost">End Session</button>
        <button id="gta-export" class="btn">Export</button>
        <button id="gta-clear-session" class="btn ghost">Clear Session Logs</button>
      </div>

      <div style="margin-top:14px" class="row">
        <div style="flex:1" class="card">
          <div class="small">Main time left</div>
          <div class="h1" id="main-time" style="font-weight:900">03:00:00</div>
        </div>
        <div style="width:160px" class="card">
          <div class="small">Question #</div>
          <div class="h1" id="q-number">—</div>
        </div>
        <div style="width:280px" class="card">
          <div class="small">Question timer</div>
          <div class="h1" id="q-timer">00:00.0</div>
          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
            <button id="q-start" class="btn">Start</button>
            <button id="q-pause" class="btn ghost" disabled>Pause</button>
            <button id="q-resume" class="btn ghost" disabled>Resume</button>
            <button id="q-submit" class="btn" disabled>Submit</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div style="display:flex;align-items:center;justify-content:space-between">
        <div><div class="h1">Session Logs</div><div class="small">Logs appear after submit. Mark result anytime (Correct awards XP).</div></div>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="merge" class="btn ghost" disabled>Merge Selected (2)</button>
          <button id="undo-merge" class="btn ghost" disabled>Undo Merge</button>
        </div>
      </div>

      <div id="gta-log-list" class="list small" style="margin-top:12px; max-height:520px; overflow:auto"></div>
    </div>
  </main>
</div>

<footer style="color:rgba(200,220,255,0.12);text-align:center;padding:14px">Sunstrike Ultra • Solo-Leveling skin</footer>

<!-- SheetJS for Excel export -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="utils.js"></script>
<script>
/* Final animated GTA (uses utils.js)
   - Reduced-motion toggle stored in localStorage ('su_reduced_motion')
   - Particle canvas for correct-mark bursts (disabled in reduced mode)
   - No sounds (you requested no SFX)
   - XP model: B (award only on marking Correct)
*/

(() => {
  // ---------- state ----------
  let gtaRunning = false;
  let mainSeconds = 180*60;
  let qNumber = 0;
  let qState = 'idle'; // idle | running | paused
  let qStart = 0, qElapsed = 0, qInterval = null;
  let lastMerge = null;
  const PRACT = SU.KEYS.PRACTICE;

  // reduced motion
  const RED_KEY = 'su_reduced_motion';
  let reducedMotion = (localStorage.getItem(RED_KEY) === '1');

  // particle system
  const pCanvas = document.getElementById('particle-canvas');
  const pCtx = pCanvas.getContext('2d');
  let particles = [];
  function resizeCanvas(){ pCanvas.width = window.innerWidth; pCanvas.height = window.innerHeight; }
  resizeCanvas(); window.addEventListener('resize', resizeCanvas);

  function spawnParticles(x,y,color){
    if(reducedMotion) return;
    for(let i=0;i<22;i++){
      particles.push({
        x, y,
        vx: (Math.random()-0.5)*6,
        vy: (Math.random()-0.9)*6 - 2,
        life: 60 + Math.random()*30,
        size: 4 + Math.random()*5,
        color
      });
    }
  }
  function tickParticles(){
    if(particles.length===0){ pCtx.clearRect(0,0,pCanvas.width,pCanvas.height); return; }
    pCtx.clearRect(0,0,pCanvas.width,pCanvas.height);
    for(let i=particles.length-1;i>=0;i--){
      const p = particles[i];
      p.x += p.vx; p.y += p.vy; p.vy += 0.15;
      p.life--;
      pCtx.globalAlpha = Math.max(0, p.life/90);
      pCtx.fillStyle = p.color;
      pCtx.beginPath();
      pCtx.arc(p.x,p.y,p.size * (p.life/90),0,Math.PI*2);
      pCtx.fill();
      if(p.life<=0) particles.splice(i,1);
    }
  }
  setInterval(tickParticles, 30);

  // ---------- util ----------
  const el = id => document.getElementById(id);
  function fmtMS(ms){
    const s = Math.floor(ms/1000);
    const mm = String(Math.floor(s/60)).padStart(2,'0');
    const ss = String(s%60).padStart(2,'0');
    const t = Math.floor(ms%1000/100);
    return `${mm}:${ss}.${t}`;
  }
  function fmtMain(sec){
    if(sec<0) sec=0; const h=Math.floor(sec/3600), m=Math.floor((sec%3600)/60), s=Math.floor(sec%60);
    return [String(h).padStart(2,'0'),String(m).padStart(2,'0'),String(s).padStart(2,'0')].join(':');
  }
  function calcPoints(timeSec, diff){
    const base = diff==='Easy'?8:diff==='Medium'?15:diff==='Hard'?40:diff==='Insane'?80:10;
    const pts = Math.max(0, Math.round(base - Math.floor(timeSec/4)));
    return Math.max(1, pts);
  }

  // ---------- header / reduced motion ----------
  function updateReducedToggleUI(){
    el('reduced-toggle').textContent = 'Reduced motion: ' + (reducedMotion? 'On' : 'Off');
  }
  el('reduced-toggle').addEventListener('click', ()=>{
    reducedMotion = !reducedMotion;
    localStorage.setItem(RED_KEY, reducedMotion? '1' : '0');
    updateReducedToggleUI();
  });
  updateReducedToggleUI();

  // ---------- render UI ----------
  function renderHeader(){
    el('main-time').textContent = fmtMain(mainSeconds);
    el('q-number').textContent = qNumber>0 ? qNumber : '—';
    // timer shimmer
    if(qState === 'running' && !reducedMotion) el('q-timer').classList.add('timer-running'); else el('q-timer').classList.remove('timer-running');
    el('q-start').disabled = !gtaRunning || qState === 'running';
    el('q-pause').disabled = qState !== 'running';
    el('q-resume').disabled = qState !== 'paused';
    el('q-submit').disabled = qState !== 'running';
  }

  function autoScrollToLatest(){
    const root = el('gta-log-list'); root.scrollTop = root.scrollHeight;
  }

  function renderLogs(){
    const sessionName = el('gta-session').value || localStorage.getItem('su_default_gta') || '';
    const root = el('gta-log-list');
    root.innerHTML = '';
    if(!sessionName){ root.innerHTML = '<div class="small">Set a session name and start.</div>'; disableMerge(); return; }
    const sessionKey = 'GTA:' + sessionName;
    const all = load(PRACT, []).filter(x => x.session === sessionKey).sort((a,b)=> (a.t||0)-(b.t||0));
    if(all.length === 0){ root.innerHTML = '<div class="small">No logs yet for this session.</div>'; disableMerge(); return; }

    all.forEach((log, idx) => {
      const wrap = document.createElement('div'); wrap.className = 'topic';
      if(idx === all.length-1) wrap.classList.add('latest');
      const left = document.createElement('div'); left.style.display='flex'; left.style.alignItems='center';
      const cb = document.createElement('input'); cb.type = 'checkbox'; cb.className = 'merge-cb'; cb.dataset.t = log.t; cb.style.marginRight='8px';
      left.appendChild(cb);
      const info = document.createElement('div'); info.innerHTML = `<strong>Q${log.q || (idx+1)} • ${log.subject}${log.topic? ' • '+log.topic : ''}</strong><div class="small">${log.diff} • ${log.time}s • ${new Date(log.t).toLocaleString()}</div>`;
      left.appendChild(info);

      const right = document.createElement('div'); right.style.display='flex'; right.style.flexDirection='column'; right.style.alignItems='flex-end';
      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px'; row.style.alignItems='center';

      // buttons
      const bCorrect = document.createElement('button'); bCorrect.className='result-btn correct'; bCorrect.textContent=' ✅';
      const bIncorrect = document.createElement('button'); bIncorrect.className='result-btn incorrect'; bIncorrect.textContent='❌';
      const bUn = document.createElement('button'); bUn.className='result-btn un'; bUn.textContent='◯';

      // badge
      const badge = document.createElement('div'); badge.className='badge';
      badge.textContent = `${log.points} pts${log.awarded? ' ✓' : ''}`;

      // style according to result
      function refreshButtons(){
        bCorrect.style.opacity = log.result==='Correct'? '1' : '0.6';
        bIncorrect.style.opacity = log.result==='Incorrect'? '1' : '0.6';
        bUn.style.opacity = log.result==='Unattempted' || log.result==='Pending'? '1' : '0.6';
        badge.textContent = `${log.points} pts${log.awarded? ' ✓' : ''}`;
      }
      refreshButtons();

      // handlers
      bCorrect.addEventListener('click', ()=> markResult(log.t, 'Correct', bCorrect));
      bIncorrect.addEventListener('click', ()=> markResult(log.t, 'Incorrect', bIncorrect));
      bUn.addEventListener('click', ()=> markResult(log.t, 'Unattempted', bUn));

      row.appendChild(bCorrect); row.appendChild(bIncorrect); row.appendChild(bUn); row.appendChild(badge);

      const del = document.createElement('button'); del.className='btn ghost'; del.textContent='Delete';
      del.onclick = ()=> { if(!confirm('Delete this log?')) return; let arr = load(PRACT, []); arr = arr.filter(x => x.t !== log.t); save(PRACT, arr); renderLogs(); };

      right.appendChild(row); right.appendChild(del);

      const container = document.createElement('div'); container.style.display='flex'; container.style.justifyContent='space-between'; container.style.alignItems='center';
      container.appendChild(left); container.appendChild(right);
      wrap.appendChild(container);
      root.appendChild(wrap);
    });

    document.querySelectorAll('.merge-cb').forEach(cb => cb.addEventListener('change', onMergeSelectionChange));
    updateMergeButtons();
    autoScrollToLatest();
  }

  function updateMergeButtons(){
    const checks = Array.from(document.querySelectorAll('.merge-cb') || []).filter(c=> c.checked);
    el('merge').disabled = checks.length !== 2;
    el('undo-merge').disabled = !lastMerge;
  }
  function disableMerge(){ el('merge').disabled = true; el('undo-merge').disabled = !lastMerge; }

  // ---------- result marking (B: award only when marking Correct) ----------
  function markResult(ts, result, btnEl){
    const arr = load(PRACT, []);
    const i = arr.findIndex(x=> x.t === ts);
    if(i === -1) return;
    const entry = arr[i];
    const prev = entry.result;
    entry.result = result;
    // award only on Correct and only if not already awarded
    if(result === 'Correct' && !entry.awarded){
      addXP(entry.points, 'gta');
      entry.awarded = true;
      // particles (burst behind the clicked button)
      if(!reducedMotion){
        // compute position: center of button
        const rect = btnEl.getBoundingClientRect();
        spawnParticles(rect.left + rect.width/2, rect.top + rect.height/2, 'rgba(168,85,247,0.95)');
      }
      // visual pulse
      btnEl.animate([{ transform:'scale(1.0)' }, { transform:'scale(1.08)' }, { transform:'scale(1.0)' }], { duration:300, easing:'ease-out' });
    }
    // if marking Incorrect or Unattempted, we do not subtract XP even if previously awarded to avoid negative surprises (intentional)
    arr[i] = entry;
    save(PRACT, arr);
    renderLogs();
  }

  // ---------- question timer controls ----------
  function qStart(){
    if(!gtaRunning){ alert('Start GTA session first'); return; }
    if(qState === 'running') return;
    qNumber += 1;
    qStart = Date.now() - qElapsed;
    qInterval = setInterval(()=> {
      qElapsed = Date.now() - qStart;
      el('q-timer').textContent = fmtMS(qElapsed);
    }, 100);
    qState = 'running';
    renderHeader();
  }
  function qPause(){
    if(qState !== 'running') return;
    clearInterval(qInterval); qInterval = null;
    qState = 'paused';
    renderHeader();
  }
  function qResume(){
    if(qState !== 'paused') return;
    qStart = Date.now() - qElapsed;
    qInterval = setInterval(()=> {
      qElapsed = Date.now() - qStart;
      el('q-timer').textContent = fmtMS(qElapsed);
    }, 100);
    qState = 'running';
    renderHeader();
  }
  function qResetAfterSubmit(){
    if(qInterval) clearInterval(qInterval);
    qInterval = null;
    qElapsed = 0;
    qState = 'idle';
    el('q-timer').textContent = '00:00.0';
    renderHeader();
  }

  // ---------- submit (non-blocking) ----------
  function qSubmit(){
    if(qState === 'paused'){ alert('Resume before submitting.'); return; }
    if(qState !== 'running'){ alert('Start the question before submitting.'); return; }
    if(qInterval){ clearInterval(qInterval); qInterval = null; }
    const timeSec = Math.round((qElapsed||0)/1000);
    if(timeSec > mainSeconds){
      alert('Time exceeded remaining main time — submission rejected. Session continues.');
      qResetAfterSubmit();
      return;
    }
    const name = el('gta-session').value || localStorage.getItem('su_default_gta') || ('GTA_'+new Date().toISOString().slice(0,10)+'_'+Math.floor(Math.random()*1000));
    el('gta-session').value = name;
    localStorage.setItem('su_default_gta', name);
    const sessionKey = 'GTA:'+name;
    const sub = el('gta-sub').value || 'Mixed';
    const diff = el('gta-diff').value || 'Mixed';
    const pts = calcPoints(timeSec, diff);

    const entry = { session: sessionKey, subject: sub, topic: '', diff, time: timeSec, points: pts, result: 'Pending', awarded: false, q: qNumber, t: Date.now() };
    const ok = savePracticeEntry(entry);
    if(!ok){ alert('Duplicate prevented (try again)'); qResetAfterSubmit(); return; }

    mainSeconds -= timeSec; if(mainSeconds < 0) mainSeconds = 0;
    renderHeader();
    renderLogs();
    qResetAfterSubmit();
  }

  // ---------- merge/undo ----------
  function mergeHandler(){
    const checks = Array.from(document.querySelectorAll('.merge-cb') || []).filter(c=> c.checked);
    if(checks.length !== 2) return alert('Select exactly 2 logs to merge.');
    const t1 = Number(checks[0].dataset.t), t2 = Number(checks[1].dataset.t);
    const arr = load(PRACT, []);
    const l1 = arr.find(x=> x.t === t1), l2 = arr.find(x=> x.t === t2);
    if(!l1 || !l2) return alert('Selected logs not found.');
    if(l1.session !== l2.session){ if(!confirm('Selected logs are from different sessions. Merge anyway?')) return; }
    const combinedTime = (Number(l1.time)||0) + (Number(l2.time)||0);
    const newDiff = l2.diff || l1.diff || 'Mixed';
    const newQ = Math.min(l1.q||9999, l2.q||9999);
    const newPoints = calcPoints(Math.round(combinedTime), newDiff);
    const newEntry = { session: l1.session, subject: l2.subject||l1.subject, topic: (l1.topic||'') + (l2.topic? ' + '+l2.topic : ''), diff: newDiff, time: Math.round(combinedTime), points: newPoints, result: l2.result || 'Pending', awarded: false, q: newQ, t: Date.now() };

    lastMerge = { removed: [l1, l2], added: newEntry };
    const remaining = arr.filter(x => x.t !== t1 && x.t !== t2);
    remaining.push(newEntry);
    save(PRACT, remaining);
    alert(`Merged logs → ${newEntry.time}s • result: ${newEntry.result} • points: ${newEntry.points}`);
    renderLogs();
    updateMergeButtons();
  }

  function undoMerge(){
    if(!lastMerge) return alert('No merge to undo.');
    const arr = load(PRACT, []);
    const remaining = arr.filter(x => x.t !== lastMerge.added.t);
    remaining.push(...lastMerge.removed);
    save(PRACT, remaining);
    lastMerge = null;
    alert('Undo merge done.');
    renderLogs();
    updateMergeButtons();
  }

  // ---------- export / clear ----------
  function exportHandler(){
    const name = el('gta-session').value || localStorage.getItem('su_default_gta') || '';
    if(!name) return alert('Set session name first.');
    const session = 'GTA:'+name;
    const all = load(PRACT, []).filter(x=> x.session === session);
    if(!all.length) return alert('No logs to export.');
    const seen = {}; const unique = [];
    all.forEach(r => { if(!seen[r.t]){ seen[r.t]=true; unique.push(r); }});
    const ws = [['Date','Session','Q#','Subject','Topic','Difficulty','Time(s)','Result','Points','Awarded']];
    unique.forEach(r => ws.push([ new Date(r.t).toLocaleString(), r.session, r.q||'', r.subject, r.topic||'', r.diff, r.time, r.result, r.points, r.awarded? 'Yes':'No' ]));
    const wb = XLSX.utils.book_new(); const ws1 = XLSX.utils.aoa_to_sheet(ws);
    XLSX.utils.book_append_sheet(wb, ws1, 'GTA'); XLSX.writeFile(wb, 'Sunstrike_GTA_'+name+'.xlsx');
  }

  function clearSession(){
    const name = el('gta-session').value || localStorage.getItem('su_default_gta') || '';
    if(!name) return alert('No session name set');
    if(!confirm('Clear ALL logs for this session?')) return;
    let arr = load(PRACT, []);
    arr = arr.filter(x => x.session !== ('GTA:'+name));
    save(PRACT, arr);
    renderLogs();
  }

  // ---------- events ----------
  el('q-start').addEventListener('click', ()=>{ qStart(); });
  el('q-pause').addEventListener('click', ()=>{ qPause(); });
  el('q-resume').addEventListener('click', ()=>{ qResume(); });
  el('q-submit').addEventListener('click', ()=>{ qSubmit(); });

  el('gta-start').addEventListener('click', ()=>{
    if(gtaRunning) return alert('GTA already running');
    const tn = Number(el('gta-total').value || 180);
    mainSeconds = tn*60;
    el('main-time').textContent = fmtMain(mainSeconds);
    el('gta-session').value = el('gta-session').value || ('GTA_'+new Date().toISOString().slice(0,10)+'_'+Math.floor(Math.random()*1000));
    localStorage.setItem('su_default_gta', el('gta-session').value);
    gtaRunning = true;
    qNumber = 0; qElapsed = 0; qState = 'idle';
    renderHeader(); renderLogs();
    alert('GTA started. Main timer is static and will be reduced only when you submit questions.');
  });

  el('gta-end').addEventListener('click', ()=>{ if(!gtaRunning) return; if(!confirm('End GTA session now?')) return; gtaRunning = false; renderHeader(); });

  el('merge').addEventListener('click', mergeHandler);
  el('undo-merge').addEventListener('click', undoMerge);
  el('gta-export').addEventListener('click', exportHandler);
  el('gta-clear-session').addEventListener('click', clearSession);

  function onMergeSelectionChange(){ updateMergeButtons(); }
  function updateMergeButtons(){ const checks = Array.from(document.querySelectorAll('.merge-cb') || []).filter(c=> c.checked); el('merge').disabled = checks.length !== 2; el('undo-merge').disabled = !lastMerge; }

  window.addEventListener('storage', (e)=>{ if(e.key === PRACT) renderLogs(); });

  // ---------- animation frame for particles ----------
  (function rafLoop(){ tickParticles(); requestAnimationFrame(rafLoop); })();

  // ---------- initialize ----------
  // reduced motion initial
  reducedMotion = (localStorage.getItem(RED_KEY) === '1');
  updateReducedToggleUI();

  // attach reduced toggle UI (reads/writes in click handler above)
  function updateReducedToggleUI(){ el('reduced-toggle').textContent = 'Reduced motion: ' + (localStorage.getItem(RED_KEY) === '1' ? 'On' : 'Off'); }

  // initial render
  renderHeader(); renderLogs();

})();
</script>
</body>
</html>